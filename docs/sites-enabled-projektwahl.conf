# SPDX-License-Identifier: AGPL-3.0-or-later
# SPDX-FileCopyrightText: 2021 Moritz Hedtke <Moritz.Hedtke@t-online.de>
server {
  server_name  localhost;
  listen       443 ssl http2;

  ssl_certificate /run/secrets/server-certificate;
  ssl_certificate_key /run/secrets/server-key;
  
  client_max_body_size 15k;
         
  location = /favicon.ico {
    expires max;
    root   /opt/projektwahl-lit/dist/;
    try_files /favicon.ico =404;
  }

  location / {
    expires epoch;
    root   /opt/projektwahl-lit/dist/;
    try_files /index.html =404;
  }

  location /dist {
    expires max;  
    root   /opt/projektwahl-lit/;
    try_files $uri =404;
  }

  location /node_modules {
    expires epoch;
    root   /opt/projektwahl-lit/;
    try_files $uri =404;
  }

  location /src {
    expires epoch;
    root   /opt/projektwahl-lit/;
    try_files $uri =404;
  }

  location /api {
    proxy_pass https://localhost:8443;
  }
}
